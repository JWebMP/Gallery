(function(factory){"use strict";if(typeof define==="function"&&define.amd){define(["./blueimp-helper"],factory)}else{window.blueimp=window.blueimp||{};window.blueimp.Gallery=factory(window.blueimp.helper||window.jQuery)}})(function($){"use strict";function Gallery(list,options){if(document.body.style.maxHeight===undefined){return null}if(!this||this.options!==Gallery.prototype.options){return new Gallery(list,options)}if(!list||!list.length){this.console.log("blueimp Gallery: No or empty list provided as first argument.",list);return}this.list=list;this.num=list.length;this.initOptions(options);this.initialize()}$.extend(Gallery.prototype,{options:{container:"#blueimp-gallery",slidesContainer:"div",titleElement:"h3",displayClass:"blueimp-gallery-display",controlsClass:"blueimp-gallery-controls",singleClass:"blueimp-gallery-single",leftEdgeClass:"blueimp-gallery-left",rightEdgeClass:"blueimp-gallery-right",playingClass:"blueimp-gallery-playing",svgasimgClass:"blueimp-gallery-svgasimg",smilClass:"blueimp-gallery-smil",slideClass:"slide",slideActiveClass:"slide-active",slidePrevClass:"slide-prev",slideNextClass:"slide-next",slideLoadingClass:"slide-loading",slideErrorClass:"slide-error",slideContentClass:"slide-content",toggleClass:"toggle",prevClass:"prev",nextClass:"next",closeClass:"close",playPauseClass:"play-pause",typeProperty:"type",titleProperty:"title",altTextProperty:"alt",urlProperty:"href",srcsetProperty:"srcset",sizesProperty:"sizes",sourcesProperty:"sources",displayTransition:true,clearSlides:true,toggleControlsOnEnter:true,toggleControlsOnSlideClick:true,toggleSlideshowOnSpace:true,enableKeyboardNavigation:true,closeOnEscape:true,closeOnSlideClick:true,closeOnSwipeUpOrDown:true,closeOnHashChange:true,emulateTouchEvents:true,stopTouchEventsPropagation:false,hidePageScrollbars:true,disableScroll:true,carousel:false,continuous:true,unloadElements:true,startSlideshow:false,slideshowInterval:5e3,slideshowDirection:"ltr",index:0,preloadRange:2,transitionDuration:300,slideshowTransitionDuration:500,event:undefined,onopen:undefined,onopened:undefined,onslide:undefined,onslideend:undefined,onslidecomplete:undefined,onclose:undefined,onclosed:undefined},carouselOptions:{hidePageScrollbars:false,toggleControlsOnEnter:false,toggleSlideshowOnSpace:false,enableKeyboardNavigation:false,closeOnEscape:false,closeOnSlideClick:false,closeOnSwipeUpOrDown:false,closeOnHashChange:false,disableScroll:false,startSlideshow:true},console:window.console&&typeof window.console.log==="function"?window.console:{log:function(){}},support:function(element){var support={source:!!window.HTMLSourceElement,picture:!!window.HTMLPictureElement,svgasimg:document.implementation.hasFeature("http://www.w3.org/TR/SVG11/feature#Image","1.1"),smil:!!document.createElementNS&&/SVGAnimate/.test(document.createElementNS("http://www.w3.org/2000/svg","animate").toString()),touch:window.ontouchstart!==undefined||window.DocumentTouch&&document instanceof DocumentTouch};var transitions={webkitTransition:{end:"webkitTransitionEnd",prefix:"-webkit-"},MozTransition:{end:"transitionend",prefix:"-moz-"},OTransition:{end:"otransitionend",prefix:"-o-"},transition:{end:"transitionend",prefix:""}};var prop;for(prop in transitions){if(Object.prototype.hasOwnProperty.call(transitions,prop)&&element.style[prop]!==undefined){support.transition=transitions[prop];support.transition.name=prop;break}}function elementTests(){var transition=support.transition;var prop;var translateZ;document.body.appendChild(element);if(transition){prop=transition.name.slice(0,-9)+"ransform";if(element.style[prop]!==undefined){element.style[prop]="translateZ(0)";translateZ=window.getComputedStyle(element).getPropertyValue(transition.prefix+"transform");support.transform={prefix:transition.prefix,name:prop,translate:true,translateZ:!!translateZ&&translateZ!=="none"}}}document.body.removeChild(element)}if(document.body){elementTests()}else{$(document).on("DOMContentLoaded",elementTests)}return support}(document.createElement("div")),requestAnimationFrame:window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame,cancelAnimationFrame:window.cancelAnimationFrame||window.webkitCancelRequestAnimationFrame||window.webkitCancelAnimationFrame||window.mozCancelAnimationFrame,initialize:function(){this.initStartIndex();if(this.initWidget()===false){return false}this.initEventListeners();this.onslide(this.index);this.ontransitionend();if(this.options.startSlideshow){this.play()}},slide:function(to,duration){window.clearTimeout(this.timeout);var index=this.index;var direction;var naturalDirection;var diff;if(index===to||this.num===1){return}if(!duration){duration=this.options.transitionDuration}if(this.support.transform){if(!this.options.continuous){to=this.circle(to)}direction=Math.abs(index-to)/(index-to);if(this.options.continuous){naturalDirection=direction;direction=-this.positions[this.circle(to)]/this.slideWidth;if(direction!==naturalDirection){to=-direction*this.num+to}}diff=Math.abs(index-to)-1;while(diff){diff-=1;this.move(this.circle((to>index?to:index)-diff-1),this.slideWidth*direction,0)}to=this.circle(to);this.move(index,this.slideWidth*direction,duration);this.move(to,0,duration);if(this.options.continuous){this.move(this.circle(to-direction),-(this.slideWidth*direction),0)}}else{to=this.circle(to);this.animate(index*-this.slideWidth,to*-this.slideWidth,duration)}this.onslide(to)},getIndex:function(){return this.index},getNumber:function(){return this.num},prev:function(){if(this.options.continuous||this.index){this.slide(this.index-1)}},next:function(){if(this.options.continuous||this.index<this.num-1){this.slide(this.index+1)}},play:function(time){var that=this;var nextIndex=this.index+(this.options.slideshowDirection==="rtl"?-1:1);window.clearTimeout(this.timeout);this.interval=time||this.options.slideshowInterval;if(this.elements[this.index]>1){this.timeout=this.setTimeout(!this.requestAnimationFrame&&this.slide||function(to,duration){that.animationFrameId=that.requestAnimationFrame.call(window,function(){that.slide(to,duration)})},[nextIndex,this.options.slideshowTransitionDuration],this.interval)}this.container.addClass(this.options.playingClass);this.slidesContainer[0].setAttribute("aria-live","off");if(this.playPauseElement.length){this.playPauseElement[0].setAttribute("aria-pressed","true")}},pause:function(){window.clearTimeout(this.timeout);this.interval=null;if(this.cancelAnimationFrame){this.cancelAnimationFrame.call(window,this.animationFrameId);this.animationFrameId=null}this.container.removeClass(this.options.playingClass);this.slidesContainer[0].setAttribute("aria-live","polite");if(this.playPauseElement.length){this.playPauseElement[0].setAttribute("aria-pressed","false")}},add:function(list){var i;if(!list.concat){list=Array.prototype.slice.call(list)}if(!this.list.concat){this.list=Array.prototype.slice.call(this.list)}this.list=this.list.concat(list);this.num=this.list.length;if(this.num>2&&this.options.continuous===null){this.options.continuous=true;this.container.removeClass(this.options.leftEdgeClass)}this.container.removeClass(this.options.rightEdgeClass).removeClass(this.options.singleClass);for(i=this.num-list.length;i<this.num;i+=1){this.addSlide(i);this.positionSlide(i)}this.positions.length=this.num;this.initSlides(true)},resetSlides:function(){this.slidesContainer.empty();this.unloadAllSlides();this.slides=[]},handleClose:function(){var options=this.options;this.destroyEventListeners();this.pause();this.container[0].style.display="none";this.container.removeClass(options.displayClass).removeClass(options.singleClass).removeClass(options.leftEdgeClass).removeClass(options.rightEdgeClass);if(options.hidePageScrollbars){document.body.style.overflow=this.bodyOverflowStyle}if(this.options.clearSlides){this.resetSlides()}if(this.options.onclosed){this.options.onclosed.call(this)}},close:function(){var that=this;function closeHandler(event){if(event.target===that.container[0]){that.container.off(that.support.transition.end,closeHandler);that.handleClose()}}if(this.options.onclose){this.options.onclose.call(this)}if(this.support.transition&&this.options.displayTransition){this.container.on(this.support.transition.end,closeHandler);this.container.removeClass(this.options.displayClass)}else{this.handleClose()}},circle:function(index){return(this.num+index%this.num)%this.num},move:function(index,dist,duration){this.translateX(index,dist,duration);this.positions[index]=dist},translate:function(index,x,y,duration){if(!this.slides[index])return;var style=this.slides[index].style;var transition=this.support.transition;var transform=this.support.transform;style[transition.name+"Duration"]=duration+"ms";style[transform.name]="translate("+x+"px, "+y+"px)"+(transform.translateZ?" translateZ(0)":"")},translateX:function(index,x,duration){this.translate(index,x,0,duration)},translateY:function(index,y,duration){this.translate(index,0,y,duration)},animate:function(from,to,duration){if(!duration){this.slidesContainer[0].style.left=to+"px";return}var that=this;var start=(new Date).getTime();var timer=window.setInterval(function(){var timeElap=(new Date).getTime()-start;if(timeElap>duration){that.slidesContainer[0].style.left=to+"px";that.ontransitionend();window.clearInterval(timer);return}that.slidesContainer[0].style.left=(to-from)*(Math.floor(timeElap/duration*100)/100)+from+"px"},4)},preventDefault:function(event){if(event.preventDefault){event.preventDefault()}else{event.returnValue=false}},stopPropagation:function(event){if(event.stopPropagation){event.stopPropagation()}else{event.cancelBubble=true}},onresize:function(){this.initSlides(true)},onhashchange:function(){if(this.options.closeOnHashChange){this.close()}},onmousedown:function(event){if(event.which&&event.which===1&&event.target.nodeName!=="VIDEO"&&event.target.nodeName!=="AUDIO"){event.preventDefault();(event.originalEvent||event).touches=[{pageX:event.pageX,pageY:event.pageY}];this.ontouchstart(event)}},onmousemove:function(event){if(this.touchStart){(event.originalEvent||event).touches=[{pageX:event.pageX,pageY:event.pageY}];this.ontouchmove(event)}},onmouseup:function(event){if(this.touchStart){this.ontouchend(event);delete this.touchStart}},onmouseout:function(event){if(this.touchStart){var target=event.target;var related=event.relatedTarget;if(!related||related!==target&&!$.contains(target,related)){this.onmouseup(event)}}},ontouchstart:function(event){if(this.options.stopTouchEventsPropagation){this.stopPropagation(event)}var touch=(event.originalEvent||event).touches[0];this.touchStart={x:touch.pageX,y:touch.pageY,time:Date.now()};this.isScrolling=undefined;this.touchDelta={}},ontouchmove:function(event){if(this.options.stopTouchEventsPropagation){this.stopPropagation(event)}var touches=(event.originalEvent||event).touches;var touch=touches[0];var scale=(event.originalEvent||event).scale;var index=this.index;var touchDeltaX;var indices;if(touches.length>1||scale&&scale!==1){return}if(this.options.disableScroll){event.preventDefault()}this.touchDelta={x:touch.pageX-this.touchStart.x,y:touch.pageY-this.touchStart.y};touchDeltaX=this.touchDelta.x;if(this.isScrolling===undefined){this.isScrolling=this.isScrolling||Math.abs(touchDeltaX)<Math.abs(this.touchDelta.y)}if(!this.isScrolling){event.preventDefault();window.clearTimeout(this.timeout);if(this.options.continuous){indices=[this.circle(index+1),index,this.circle(index-1)]}else{this.touchDelta.x=touchDeltaX=touchDeltaX/(!index&&touchDeltaX>0||index===this.num-1&&touchDeltaX<0?Math.abs(touchDeltaX)/this.slideWidth+1:1);indices=[index];if(index){indices.push(index-1)}if(index<this.num-1){indices.unshift(index+1)}}while(indices.length){index=indices.pop();this.translateX(index,touchDeltaX+this.positions[index],0)}}else if(!this.options.carousel){this.translateY(index,this.touchDelta.y+this.positions[index],0)}},ontouchend:function(event){if(this.options.stopTouchEventsPropagation){this.stopPropagation(event)}var index=this.index;var absTouchDeltaX=Math.abs(this.touchDelta.x);var slideWidth=this.slideWidth;var duration=Math.ceil(this.options.transitionDuration*(1-absTouchDeltaX/slideWidth)/2);var isValidSlide=absTouchDeltaX>20;var isPastBounds=!index&&this.touchDelta.x>0||index===this.num-1&&this.touchDelta.x<0;var isValidClose=!isValidSlide&&this.options.closeOnSwipeUpOrDown&&Math.abs(this.touchDelta.y)>20;var direction;var indexForward;var indexBackward;var distanceForward;var distanceBackward;if(this.options.continuous){isPastBounds=false}direction=this.touchDelta.x<0?-1:1;if(!this.isScrolling){if(isValidSlide&&!isPastBounds){indexForward=index+direction;indexBackward=index-direction;distanceForward=slideWidth*direction;distanceBackward=-slideWidth*direction;if(this.options.continuous){this.move(this.circle(indexForward),distanceForward,0);this.move(this.circle(index-2*direction),distanceBackward,0)}else if(indexForward>=0&&indexForward<this.num){this.move(indexForward,distanceForward,0)}this.move(index,this.positions[index]+distanceForward,duration);this.move(this.circle(indexBackward),this.positions[this.circle(indexBackward)]+distanceForward,duration);index=this.circle(indexBackward);this.onslide(index)}else{if(this.options.continuous){this.move(this.circle(index-1),-slideWidth,duration);this.move(index,0,duration);this.move(this.circle(index+1),slideWidth,duration)}else{if(index){this.move(index-1,-slideWidth,duration)}this.move(index,0,duration);if(index<this.num-1){this.move(index+1,slideWidth,duration)}}}}else{if(isValidClose){this.close()}else{this.translateY(index,0,duration)}}},ontouchcancel:function(event){if(this.touchStart){this.ontouchend(event);delete this.touchStart}},ontransitionend:function(event){var slide=this.slides[this.index];if(!event||slide===event.target){if(this.interval){this.play()}this.setTimeout(this.options.onslideend,[this.index,slide])}},oncomplete:function(event){var target=event.target||event.srcElement;var parent=target&&target.parentNode;var index;if(!target||!parent){return}index=this.getNodeIndex(parent);$(parent).removeClass(this.options.slideLoadingClass);if(event.type==="error"){$(parent).addClass(this.options.slideErrorClass);this.elements[index]=3}else{this.elements[index]=2}if(target.clientHeight>this.container[0].clientHeight){target.style.maxHeight=this.container[0].clientHeight}if(this.interval&&this.slides[this.index]===parent){this.play()}this.setTimeout(this.options.onslidecomplete,[index,parent])},onload:function(event){this.oncomplete(event)},onerror:function(event){this.oncomplete(event)},onkeydown:function(event){switch(event.which||event.keyCode){case 13:if(this.options.toggleControlsOnEnter){this.preventDefault(event);this.toggleControls()}break;case 27:if(this.options.closeOnEscape){this.close();event.stopImmediatePropagation()}break;case 32:if(this.options.toggleSlideshowOnSpace){this.preventDefault(event);this.toggleSlideshow()}break;case 37:if(this.options.enableKeyboardNavigation){this.preventDefault(event);this.prev()}break;case 39:if(this.options.enableKeyboardNavigation){this.preventDefault(event);this.next()}break}},handleClick:function(event){var options=this.options;var target=event.target||event.srcElement;var parent=target.parentNode;function isTarget(className){return $(target).hasClass(className)||$(parent).hasClass(className)}if(isTarget(options.toggleClass)){this.preventDefault(event);this.toggleControls()}else if(isTarget(options.prevClass)){this.preventDefault(event);this.prev()}else if(isTarget(options.nextClass)){this.preventDefault(event);this.next()}else if(isTarget(options.closeClass)){this.preventDefault(event);this.close()}else if(isTarget(options.playPauseClass)){this.preventDefault(event);this.toggleSlideshow()}else if(parent===this.slidesContainer[0]){if(options.closeOnSlideClick){this.preventDefault(event);this.close()}else if(options.toggleControlsOnSlideClick){this.preventDefault(event);this.toggleControls()}}else if(parent.parentNode&&parent.parentNode===this.slidesContainer[0]){if(options.toggleControlsOnSlideClick){this.preventDefault(event);this.toggleControls()}}},onclick:function(event){if(this.options.emulateTouchEvents&&this.touchDelta&&(Math.abs(this.touchDelta.x)>20||Math.abs(this.touchDelta.y)>20)){delete this.touchDelta;return}return this.handleClick(event)},updateEdgeClasses:function(index){if(!index){this.container.addClass(this.options.leftEdgeClass)}else{this.container.removeClass(this.options.leftEdgeClass)}if(index===this.num-1){this.container.addClass(this.options.rightEdgeClass)}else{this.container.removeClass(this.options.rightEdgeClass)}},updateActiveSlide:function(oldIndex,newIndex){var slides=this.slides;var options=this.options;var list=[{index:newIndex,method:"addClass",hidden:false},{index:oldIndex,method:"removeClass",hidden:true}];var item,index;while(list.length){item=list.pop();$(slides[item.index])[item.method](options.slideActiveClass);index=this.circle(item.index-1);if(options.continuous||index<item.index){$(slides[index])[item.method](options.slidePrevClass)}index=this.circle(item.index+1);if(options.continuous||index>item.index){$(slides[index])[item.method](options.slideNextClass)}}this.slides[oldIndex].setAttribute("aria-hidden","true");this.slides[newIndex].removeAttribute("aria-hidden")},handleSlide:function(oldIndex,newIndex){if(!this.options.continuous){this.updateEdgeClasses(newIndex)}this.updateActiveSlide(oldIndex,newIndex);this.loadElements(newIndex);if(this.options.unloadElements){this.unloadElements(oldIndex,newIndex)}this.setTitle(newIndex)},onslide:function(index){this.handleSlide(this.index,index);this.index=index;this.setTimeout(this.options.onslide,[index,this.slides[index]])},setTitle:function(index){var firstChild=this.slides[index].firstChild;var text=firstChild.title||firstChild.alt;var titleElement=this.titleElement;if(titleElement.length){this.titleElement.empty();if(text){titleElement[0].appendChild(document.createTextNode(text))}}},setTimeout:function(func,args,wait){var that=this;return func&&window.setTimeout(function(){func.apply(that,args||[])},wait||0)},imageFactory:function(obj,callback){var options=this.options;var that=this;var url=obj;var img=this.imagePrototype.cloneNode(false);var picture;var called;var sources;var srcset;var sizes;var title;var altText;var i;function callbackWrapper(event){if(!called){event={type:event.type,target:picture||img};if(!event.target.parentNode){return that.setTimeout(callbackWrapper,[event])}called=true;$(img).off("load error",callbackWrapper);callback(event)}}if(typeof url!=="string"){url=this.getItemProperty(obj,options.urlProperty);sources=this.support.picture&&this.support.source&&this.getItemProperty(obj,options.sourcesProperty);srcset=this.getItemProperty(obj,options.srcsetProperty);sizes=this.getItemProperty(obj,options.sizesProperty);title=this.getItemProperty(obj,options.titleProperty);altText=this.getItemProperty(obj,options.altTextProperty)||title}img.draggable=false;if(title){img.title=title}if(altText){img.alt=altText}$(img).on("load error",callbackWrapper);if(sources&&sources.length){picture=this.picturePrototype.cloneNode(false);for(i=0;i<sources.length;i+=1){picture.appendChild($.extend(this.sourcePrototype.cloneNode(false),sources[i]))}picture.appendChild(img);$(picture).addClass(options.toggleClass)}if(srcset){if(sizes){img.sizes=sizes}img.srcset=srcset}img.src=url;if(picture)return picture;return img},createElement:function(obj,callback){var type=obj&&this.getItemProperty(obj,this.options.typeProperty);var factory=type&&this[type.split("/")[0]+"Factory"]||this.imageFactory;var element=obj&&factory.call(this,obj,callback);if(!element){element=this.elementPrototype.cloneNode(false);this.setTimeout(callback,[{type:"error",target:element}])}$(element).addClass(this.options.slideContentClass);return element},iteratePreloadRange:function(index,func){var num=this.num;var options=this.options;var limit=Math.min(num,options.preloadRange*2+1);var j=index;var i;for(i=0;i<limit;i+=1){j+=i*(i%2===0?-1:1);if(j<0||j>=num){if(!options.continuous)continue;j=this.circle(j)}func.call(this,j)}},loadElement:function(index){if(!this.elements[index]){if(this.slides[index].firstChild){this.elements[index]=$(this.slides[index]).hasClass(this.options.slideErrorClass)?3:2}else{this.elements[index]=1;$(this.slides[index]).addClass(this.options.slideLoadingClass);this.slides[index].appendChild(this.createElement(this.list[index],this.proxyListener))}}},loadElements:function(index){this.iteratePreloadRange(index,this.loadElement)},unloadElements:function(oldIndex,newIndex){var preloadRange=this.options.preloadRange;this.iteratePreloadRange(oldIndex,function(i){var diff=Math.abs(i-newIndex);if(diff>preloadRange&&diff+preloadRange<this.num){this.unloadSlide(i);delete this.elements[i]}})},addSlide:function(index){var slide=this.slidePrototype.cloneNode(false);slide.setAttribute("data-index",index);slide.setAttribute("aria-hidden","true");this.slidesContainer[0].appendChild(slide);this.slides.push(slide)},positionSlide:function(index){var slide=this.slides[index];slide.style.width=this.slideWidth+"px";if(this.support.transform){slide.style.left=index*-this.slideWidth+"px";this.move(index,this.index>index?-this.slideWidth:this.index<index?this.slideWidth:0,0)}},initSlides:function(reload){var clearSlides,i;if(!reload){this.positions=[];this.positions.length=this.num;this.elements={};this.picturePrototype=this.support.picture&&document.createElement("picture");this.sourcePrototype=this.support.source&&document.createElement("source");this.imagePrototype=document.createElement("img");this.elementPrototype=document.createElement("div");this.slidePrototype=this.elementPrototype.cloneNode(false);$(this.slidePrototype).addClass(this.options.slideClass);this.slides=this.slidesContainer[0].children;clearSlides=this.options.clearSlides||this.slides.length!==this.num}this.slideWidth=this.container[0].clientWidth;this.slideHeight=this.container[0].clientHeight;this.slidesContainer[0].style.width=this.num*this.slideWidth+"px";if(clearSlides){this.resetSlides()}for(i=0;i<this.num;i+=1){if(clearSlides){this.addSlide(i)}this.positionSlide(i)}if(this.options.continuous&&this.support.transform){this.move(this.circle(this.index-1),-this.slideWidth,0);this.move(this.circle(this.index+1),this.slideWidth,0)}if(!this.support.transform){this.slidesContainer[0].style.left=this.index*-this.slideWidth+"px"}},unloadSlide:function(index){var slide,firstChild;slide=this.slides[index];firstChild=slide.firstChild;if(firstChild!==null){slide.removeChild(firstChild)}},unloadAllSlides:function(){var i,len;for(i=0,len=this.slides.length;i<len;i++){this.unloadSlide(i)}},toggleControls:function(){var controlsClass=this.options.controlsClass;if(this.container.hasClass(controlsClass)){this.container.removeClass(controlsClass)}else{this.container.addClass(controlsClass)}},toggleSlideshow:function(){if(!this.interval){this.play()}else{this.pause()}},getNodeIndex:function(element){return parseInt(element.getAttribute("data-index"),10)},getNestedProperty:function(obj,property){property.replace(/\[(?:'([^']+)'|"([^"]+)"|(\d+))\]|(?:(?:^|\.)([^\.\[]+))/g,function(str,singleQuoteProp,doubleQuoteProp,arrayIndex,dotProp){var prop=dotProp||singleQuoteProp||doubleQuoteProp||arrayIndex&&parseInt(arrayIndex,10);if(str&&obj){obj=obj[prop]}});return obj},getDataProperty:function(obj,property){var key;var prop;if(obj.dataset){key=property.replace(/-([a-z])/g,function(_,b){return b.toUpperCase()});prop=obj.dataset[key]}else if(obj.getAttribute){prop=obj.getAttribute("data-"+property.replace(/([A-Z])/g,"-$1").toLowerCase())}if(typeof prop==="string"){if(/^(true|false|null|-?\d+(\.\d+)?|\{[\s\S]*\}|\[[\s\S]*\])$/.test(prop)){try{return $.parseJSON(prop)}catch(ignore){}}return prop}},getItemProperty:function(obj,property){var prop=this.getDataProperty(obj,property);if(prop===undefined){prop=obj[property]}if(prop===undefined){prop=this.getNestedProperty(obj,property)}return prop},initStartIndex:function(){var index=this.options.index;var urlProperty=this.options.urlProperty;var i;if(index&&typeof index!=="number"){for(i=0;i<this.num;i+=1){if(this.list[i]===index||this.getItemProperty(this.list[i],urlProperty)===this.getItemProperty(index,urlProperty)){index=i;break}}}this.index=this.circle(parseInt(index,10)||0)},initEventListeners:function(){var that=this;var slidesContainer=this.slidesContainer;function proxyListener(event){var type=that.support.transition&&that.support.transition.end===event.type?"transitionend":event.type;that["on"+type](event)}$(window).on("resize",proxyListener);$(window).on("hashchange",proxyListener);$(document.body).on("keydown",proxyListener);this.container.on("click",proxyListener);if(this.support.touch){slidesContainer.on("touchstart touchmove touchend touchcancel",proxyListener)}else if(this.options.emulateTouchEvents&&this.support.transition){slidesContainer.on("mousedown mousemove mouseup mouseout",proxyListener)}if(this.support.transition){slidesContainer.on(this.support.transition.end,proxyListener)}this.proxyListener=proxyListener},destroyEventListeners:function(){var slidesContainer=this.slidesContainer;var proxyListener=this.proxyListener;$(window).off("resize",proxyListener);$(document.body).off("keydown",proxyListener);this.container.off("click",proxyListener);if(this.support.touch){slidesContainer.off("touchstart touchmove touchend touchcancel",proxyListener)}else if(this.options.emulateTouchEvents&&this.support.transition){slidesContainer.off("mousedown mousemove mouseup mouseout",proxyListener)}if(this.support.transition){slidesContainer.off(this.support.transition.end,proxyListener)}},handleOpen:function(){if(this.options.onopened){this.options.onopened.call(this)}},initWidget:function(){var that=this;function openHandler(event){if(event.target===that.container[0]){that.container.off(that.support.transition.end,openHandler);that.handleOpen()}}this.container=$(this.options.container);if(!this.container.length){this.console.log("blueimp Gallery: Widget container not found.",this.options.container);return false}this.slidesContainer=this.container.find(this.options.slidesContainer).first();if(!this.slidesContainer.length){this.console.log("blueimp Gallery: Slides container not found.",this.options.slidesContainer);return false}this.titleElement=this.container.find(this.options.titleElement).first();this.playPauseElement=this.container.find("."+this.options.playPauseClass).first();if(this.num===1){this.container.addClass(this.options.singleClass)}if(this.support.svgasimg){this.container.addClass(this.options.svgasimgClass)}if(this.support.smil){this.container.addClass(this.options.smilClass)}if(this.options.onopen){this.options.onopen.call(this)}if(this.support.transition&&this.options.displayTransition){this.container.on(this.support.transition.end,openHandler)}else{this.handleOpen()}if(this.options.hidePageScrollbars){this.bodyOverflowStyle=document.body.style.overflow;document.body.style.overflow="hidden"}this.container[0].style.display="block";this.initSlides();this.container.addClass(this.options.displayClass)},initOptions:function(options){this.options=$.extend({},this.options);if(options&&options.carousel||this.options.carousel&&(!options||options.carousel!==false)){$.extend(this.options,this.carouselOptions)}$.extend(this.options,options);if(this.num<3){this.options.continuous=this.options.continuous?null:false}if(!this.support.transition){this.options.emulateTouchEvents=false}if(this.options.event){this.preventDefault(this.options.event)}}});return Gallery});